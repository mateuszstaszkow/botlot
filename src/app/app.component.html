<div [class.fade-in-container]="!isLogoInitial">
  <img class="flights-logo"
       [class.flights-logo--initial]="isLogoInitial"
       alt="Angular Logo"
       src="/assets/images/logo-hd.jpg">
  <h1 class="flights-title"
      [class.flights-logo--initial]="isLogoInitial">
    BOTLOT
  </h1>

  <div class="csvg-countdown">
    <h1 class="csvg-title font-cursive"
        title="Asiunia w Polsce"
        data-tad-bind="title">
      Asiunia w Polsce
    </h1>
    <div class="csvg-countdown__content">
      <div class="csvg-digit" data-tad-bind="days">
        <div id="el_d1" class="csvg-digit-number">{{ dateLeft.getDate() < 10 ? '0' + dateLeft.getDate() : dateLeft.getDate() }}</div>
        <div id="el_d1t" class="csvg-digit-label">days</div>
      </div>
      <div class="csvg-digit" data-tad-bind="hours">
        <div id="el_h1" class="csvg-digit-number">{{ dateLeft.getHours() < 10 ? '0' + dateLeft.getHours() : dateLeft.getHours() }}</div>
        <div id="el_h1t" class="csvg-digit-label">hour</div>
      </div>
      <div class="csvg-digit" data-tad-bind="minutes">
        <div id="el_m1" class="csvg-digit-number">{{ dateLeft.getMinutes() < 10 ? '0' + dateLeft.getMinutes() : dateLeft.getMinutes() }}</div>
        <div id="el_m1t" class="csvg-digit-label">minutes</div>
      </div>
      <div class="csvg-digit" data-tad-bind="seconds">
        <div id="el_s1" class="csvg-digit-number">{{ dateLeft.getSeconds() < 10 ? '0' + dateLeft.getSeconds() : dateLeft.getSeconds() }}</div>
        <div id="el_s1t" class="csvg-digit-label">seconds</div>
      </div>
    </div>
  </div>

  <div class="flights-container">
    <div class="controls">
      <form [formGroup]="formGroup">
        <mat-form-field class="controls__search">
          <input matInput
                 placeholder="City"
                 formControlName="city"
                 [matAutocomplete]="auto">
          <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
            <mat-option *ngFor="let cityCode of citySuggestions$ | async"
                        [value]="mapToCityAndCountry(cityCode)"
                        (click)="assignCityCodeAndGetFlights(cityCode)">
              {{ mapToCityAndCountry(cityCode) }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <mat-form-field class="controls__search">
          <input matInput
                 placeholder="Search"
                 formControlName="search">
        </mat-form-field>
        <mat-form-field class="controls__number">
          <input matInput
                 placeholder="Number of People"
                 type="number"
                 formControlName="numberOfPeople">
        </mat-form-field>
        <mat-form-field class="controls__number">
          <input matInput
                 placeholder="Number of Weekends"
                 type="number"
                 min="1"
                 max="16"
                 formControlName="numberOfWeekends">
        </mat-form-field>
        <mat-form-field class="controls__number">
          <input matInput
                 placeholder="Hour Depart From"
                 type="number"
                 min="1"
                 max="23"
                 formControlName="departFrom">
        </mat-form-field>
        <mat-form-field class="controls__number">
          <input matInput
                 placeholder="Hour Return From"
                 type="number"
                 min="1"
                 max="23"
                 formControlName="returnFrom">
        </mat-form-field>
        <mat-form-field>
          <mat-label>Sort By</mat-label>
          <mat-select formControlName="sort">
            <mat-option *ngFor="let type of SORT_BY_TYPES"
                        [value]="type">
              {{ type }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </form>
      <mat-checkbox class="mx-3 mt-2"
                    color="primary"
                    (change)="sortFlightsByCurrentTotalCost()"
                    [(ngModel)]="isHotelVisible">
        Hotels
      </mat-checkbox>
      <mat-checkbox class="mx-3 mt-2"
                    color="primary"
                    (change)="sortFlightsByCurrentTotalCost()"
                    [(ngModel)]="isShuttleVisible">
        Taxis
      </mat-checkbox>
      <mat-checkbox *ngIf="isIncompleteCheckboxVisible()" class="mx-3 mt-2"
                    color="primary"
                    [(ngModel)]="isIncompleteVisible">
        Show incomplete ({{ completeIncompleteFlights + ' / ' + flightsCount }})
      </mat-checkbox>
      <div *ngIf="!isIncompleteCheckboxVisible()"
           class="controls__count">
        Flights:&nbsp;
        <strong>{{ displayedFlights.length }}</strong>
      </div>
    </div>
    <div *ngIf="progress < 100"
         class="my-5 text-center w-100">
    <span *ngIf="flightsCount > 1"
          class="ml-3">
      {{ formattedProgress + ' / ' + flightsCount + ', time left: ' + timeLeft }}
    </span>
      <mat-progress-bar *ngIf="flightsCount > 1"
                        class="flights-progress-bar"
                        mode="determinate"
                        color="primary"
                        [value]="progress">
      </mat-progress-bar>
      <span *ngIf="flightsCount === 1" class="ml-3">Loading flights</span>
      <mat-progress-bar *ngIf="flightsCount === 1"
                        class="flights-progress-bar"
                        mode="indeterminate"
                        color="primary">
      </mat-progress-bar>
    </div>
    <div *ngFor="let flight of displayedFlights">
      <div *ngIf="flight.weekend && flight.arrival && flight.depart && isFlightComplete(flight) || isIncompleteVisible"
           class="flight-row"
           [matTooltip]="'Arrival airline: ' + flight.arrival.airline + ', ' + 'Departure airline: ' + flight.depart.airline"
           [class.flight-row--error]="!isFlightComplete(flight)">
        <div class="flight-cell">
          <strong>City to:&nbsp;</strong>
          {{ flight.arrival.city + ' (' + flight.arrival.country + ')' }}
        </div>
        <div *ngIf="flight.arrival.city !== flight.depart.city"
             class="flight-cell">
          <strong>City from:&nbsp;</strong>
          {{ flight.depart.city + ' (' + flight.depart.country + ')' }}
        </div>
        <div class="flight-cell">
          <strong>Date:&nbsp;</strong>
          {{ flight.weekend.startDay + ' / ' + flight.weekend.endDay + ' (from ' + getDayName(flight) + ')' }}
        </div>
        <div class="flight-cell">
          <strong>Cost per day:&nbsp;</strong>
          {{ getPricePerDay(flight) }}
        </div>
        <div class="flight-cell">
          <strong>Total Cost:&nbsp;</strong>
          {{ getTotalCostMessageFor(flight) }}
        </div>
        <div class="flight-cell">
          <strong>Hotel:&nbsp;</strong>
          {{ flight.hotel ? flight.hotel.name : 'Unknown' }}
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="progress >= 100"
       class="footer">
    Mateusz Staszk√≥w Software Development &copy; 2021
  </div>
</div>
